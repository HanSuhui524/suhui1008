'use strict';
const fs = require('fs')

function parse(v){
    if(typeof v === 'object' && v !== null) return v;
    try{
        let o = JSON.parse(v);
        if(typeof o === 'object' && o !== null) return o;
    }catch(e){return {error:e,value:v};}
    return {value:v};
}
function reader(a,b){
    if(typeof b === "function"){
        return  fs.readFile(a,'utf8',(e,s)=>{
            return b(parse(s));;
        });
    }
    try{ return parse(fs.readFileSync(a));
    }catch(e){
        return {error:e,path:a};
    }
}
module.exports.value=function(v){return parse(v);}
module.exports.path = function(path,cb){return reader(path,cb);};